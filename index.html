<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>99942 Apophis - Orbital Mechanics Simulator</title>
        <script src="https://unpkg.com/lucide@latest"></script>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    "Helvetica Neue", Arial, sans-serif;
                background: #000;
                color: #fff;
                overflow: hidden;
            }

            #canvas-container {
                width: 100vw;
                height: 100vh;
                position: relative;
            }

            #controls {
                position: absolute;
                top: 20px;
                left: 20px;
                background: rgba(15, 23, 42, 0.95);
                padding: 24px;
                border-radius: 12px;
                border: 1px solid rgba(148, 163, 184, 0.2);
                max-width: 360px;
                max-height: 90vh;
                overflow-y: auto;
                backdrop-filter: blur(16px);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            }

            #info {
                position: absolute;
                top: 20px;
                right: 20px;
                background: rgba(15, 23, 42, 0.95);
                padding: 16px 24px;
                border-radius: 12px;
                border: 1px solid rgba(148, 163, 184, 0.2);
                max-width: 320px;
                backdrop-filter: blur(16px);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            }

            h1 {
                font-size: 1.5em;
                margin: 0 0 20px 0;
                color: #f1f5f9;
                font-weight: 600;
                letter-spacing: -0.025em;
            }

            h2 {
                font-size: 0.875rem;
                margin: 20px 0 12px 0;
                color: #94a3b8;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.05em;
            }

            .control-group {
                margin-bottom: 16px;
            }

            label {
                display: block;
                margin-bottom: 8px;
                font-size: 0.875rem;
                color: #cbd5e1;
                font-weight: 500;
            }

            input[type="range"] {
                width: 100%;
                margin: 5px 0;
            }

            select {
                width: 100%;
                padding: 8px;
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.3);
                border-radius: 5px;
                color: #fff;
                font-size: 0.9em;
                cursor: pointer;
            }

            select option {
                background: #1a1a1a;
                color: #fff;
            }

            input[type="number"] {
                width: 100%;
                padding: 5px;
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: #fff;
                border-radius: 4px;
            }

            button {
                width: 100%;
                padding: 10px 16px;
                margin: 6px 0;
                background: #3b82f6;
                color: white;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 0.875rem;
                font-weight: 500;
                transition: all 0.2s;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }

            button:hover {
                background: #2563eb;
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            }

            button:active {
                transform: translateY(0);
            }

            button.secondary {
                background: #64748b;
            }

            button.secondary:hover {
                background: #475569;
                box-shadow: 0 4px 12px rgba(100, 116, 139, 0.4);
            }

            .value-display {
                display: inline-block;
                float: right;
                color: #3b82f6;
                font-weight: 600;
                font-size: 0.875rem;
            }

            .info-item {
                margin: 12px 0;
                font-size: 0.875rem;
                line-height: 1.5;
            }

            .info-label {
                color: #94a3b8;
                font-weight: 500;
                display: block;
                margin-bottom: 4px;
            }

            .info-value {
                color: #f1f5f9;
                font-weight: 600;
                font-size: 1rem;
            }

            #controls::-webkit-scrollbar {
                width: 8px;
            }

            #controls::-webkit-scrollbar-track {
                background: rgba(255, 255, 255, 0.1);
                border-radius: 4px;
            }

            #controls::-webkit-scrollbar-thumb {
                background: rgba(255, 107, 53, 0.5);
                border-radius: 4px;
            }

            #controls::-webkit-scrollbar-thumb:hover {
                background: rgba(255, 107, 53, 0.7);
            }

            /* Modal Styles */
            .modal {
                display: none;
                position: fixed;
                z-index: 1000;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(8px);
                animation: fadeIn 0.2s ease-out;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }

            .modal-content {
                background: linear-gradient(
                    135deg,
                    rgba(15, 23, 42, 0.98) 0%,
                    rgba(30, 41, 59, 0.98) 100%
                );
                margin: 5% auto;
                padding: 32px;
                border: 1px solid rgba(148, 163, 184, 0.3);
                border-radius: 16px;
                width: 90%;
                max-width: 700px;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
                animation: slideIn 0.3s ease-out;
            }

            @keyframes slideIn {
                from {
                    transform: translateY(-50px);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            .modal-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 24px;
                padding-bottom: 16px;
                border-bottom: 1px solid rgba(148, 163, 184, 0.2);
            }

            .modal-header h2 {
                margin: 0;
                font-size: 1.5rem;
                color: #f1f5f9;
                text-transform: none;
                letter-spacing: -0.025em;
            }

            .close-modal {
                background: none;
                border: none;
                color: #94a3b8;
                cursor: pointer;
                padding: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 6px;
                transition: all 0.2s;
                width: auto;
                margin: 0;
            }

            .close-modal:hover {
                background: rgba(148, 163, 184, 0.2);
                color: #f1f5f9;
                transform: none;
                box-shadow: none;
            }

            .modal-section {
                margin-bottom: 24px;
            }

            .modal-section h3 {
                font-size: 1.125rem;
                color: #3b82f6;
                margin-bottom: 12px;
                font-weight: 600;
            }

            .modal-section p {
                color: #cbd5e1;
                line-height: 1.7;
                margin-bottom: 12px;
            }

            .modal-section ul {
                color: #cbd5e1;
                line-height: 1.7;
                margin-left: 20px;
            }

            .modal-section li {
                margin-bottom: 8px;
            }

            .warning-box {
                background: rgba(239, 68, 68, 0.1);
                border-left: 4px solid #ef4444;
                padding: 16px;
                border-radius: 8px;
                margin: 16px 0;
            }

            .warning-box p {
                color: #fca5a5;
                margin: 0;
            }

            .info-box {
                background: rgba(59, 130, 246, 0.1);
                border-left: 4px solid #3b82f6;
                padding: 16px;
                border-radius: 8px;
                margin: 16px 0;
            }

            .info-box p {
                color: #93c5fd;
                margin: 0;
            }

            /* Info Icon Button */
            .info-icon-btn {
                background: none;
                border: none;
                color: #64748b;
                cursor: pointer;
                padding: 4px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                transition: all 0.2s;
                width: 20px;
                height: 20px;
                margin: 0 0 0 8px;
                vertical-align: middle;
            }

            .info-icon-btn:hover {
                background: rgba(59, 130, 246, 0.2);
                color: #3b82f6;
                transform: none;
                box-shadow: none;
            }

            .label-with-info {
                display: flex;
                align-items: center;
                justify-content: space-between;
            }

            /* Main Info Button */
            #main-info-btn {
                position: absolute;
                top: 20px;
                right: 360px;
                background: rgba(15, 23, 42, 0.95);
                border: 1px solid rgba(148, 163, 184, 0.2);
                color: #3b82f6;
                cursor: pointer;
                padding: 12px 20px;
                border-radius: 12px;
                font-size: 0.875rem;
                font-weight: 500;
                display: flex;
                align-items: center;
                gap: 8px;
                backdrop-filter: blur(16px);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
                transition: all 0.2s;
                width: auto;
                margin: 0;
            }

            #main-info-btn:hover {
                background: rgba(59, 130, 246, 0.2);
                border-color: #3b82f6;
                transform: translateY(-1px);
                box-shadow: 0 12px 40px rgba(59, 130, 246, 0.3);
            }
        </style>
    </head>
    <body>
        <div id="canvas-container"></div>

        <!-- Main Info Button -->
        <button id="main-info-btn">
            <i data-lucide="info" style="width: 18px; height: 18px"></i>
            <span>About Apophis</span>
        </button>

        <div id="controls">
            <h1>Apophis Orbital Simulator</h1>

            <div class="control-group">
                <button id="toggle-play" class="secondary">
                    <i data-lucide="play" style="width: 16px; height: 16px"></i>
                    <span>Play</span>
                </button>
                <button id="reset-apophis">
                    <i
                        data-lucide="rotate-ccw"
                        style="width: 16px; height: 16px"
                    ></i>
                    <span>Reset Simulation</span>
                </button>
            </div>

            <h2>View Controls</h2>
            <div class="control-group">
                <button id="toggle-labels" class="secondary">
                    <i data-lucide="tag" style="width: 16px; height: 16px"></i>
                    <span>Toggle Labels</span>
                </button>
            </div>
            <div class="control-group">
                <label>Focus on Body</label>
                <select id="focus-body">
                    <option value="">Select a body...</option>
                    <option value="Sun">Sun</option>
                    <option value="Earth">Earth</option>
                    <option value="Venus">Venus</option>
                    <option value="Mars">Mars</option>
                    <option value="99942 Apophis">Apophis</option>
                </select>
            </div>

            <div id="orbital-controls"></div>
            <div id="simulation-controls"></div>
        </div>

        <div id="info">
            <h2>Simulation Data</h2>
            <div id="info-content"></div>
        </div>

        <!-- Main Info Modal -->
        <div id="main-info-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>About 99942 Apophis</h2>
                    <button class="close-modal" data-modal="main-info-modal">
                        <i data-lucide="x" style="width: 24px; height: 24px"></i>
                    </button>
                </div>

                <div class="modal-section">
                    <h3>Overview</h3>
                    <p>
                        99942 Apophis is a near-Earth asteroid approximately 370
                        meters in diameter. Discovered in 2004, it initially
                        caused concern due to a small probability of Earth
                        impact in 2029. Further observations have since ruled
                        out any impact risk for at least the next 100 years.
                    </p>
                </div>

                <div class="modal-section">
                    <h3>The 2029 Close Approach</h3>
                    <p>
                        On April 13, 2029, Apophis will pass within
                        approximately 31,000 kilometers (19,000 miles) of
                        Earth's surface - closer than some satellites in
                        geostationary orbit. This will be the closest approach
                        of an asteroid this size in recorded history.
                    </p>
                    <div class="info-box">
                        <p>
                            <strong>Key Facts:</strong> Apophis will be visible
                            to the naked eye from some locations. The close
                            approach will provide unprecedented opportunities
                            for scientific observation.
                        </p>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Orbital Mechanics & Perturbations</h3>
                    <p>
                        Apophis's orbit is influenced by gravitational
                        interactions with multiple bodies in the solar system:
                    </p>
                    <ul>
                        <li>
                            <strong>Solar Gravity:</strong> The Sun's massive
                            gravitational field is the primary force governing
                            Apophis's elliptical orbit.
                        </li>
                        <li>
                            <strong>Planetary Perturbations:</strong> Earth,
                            Venus, and Mars cause small but measurable changes
                            to the orbit over time.
                        </li>
                        <li>
                            <strong>Yarkovsky Effect:</strong> Thermal radiation
                            from the asteroid creates a tiny thrust that slowly
                            changes its orbit over decades.
                        </li>
                        <li>
                            <strong>Resonances:</strong> Gravitational resonances
                            with Earth can amplify small orbital changes.
                        </li>
                    </ul>
                </div>

                <div class="modal-section">
                    <h3>Risk Assessment</h3>
                    <div class="warning-box">
                        <p>
                            <strong>Current Risk Level: ZERO</strong><br />
                            As of 2021, NASA has confirmed that Apophis poses no
                            impact threat to Earth for at least the next 100
                            years. The 2029 close approach is safe.
                        </p>
                    </div>
                    <p>
                        However, the 2029 flyby will slightly alter Apophis's
                        orbit due to Earth's gravity. Scientists will carefully
                        track these changes to refine long-term predictions.
                    </p>
                </div>

                <div class="modal-section">
                    <h3>About This Simulator</h3>
                    <p>
                        This interactive tool uses N-body gravitational
                        simulation to model the orbital mechanics of Apophis and
                        other solar system bodies. You can:
                    </p>
                    <ul>
                        <li>
                            Adjust orbital parameters to see how they affect the
                            trajectory
                        </li>
                        <li>
                            Enable/disable gravitational perturbations from
                            other planets
                        </li>
                        <li>
                            Choose different numerical integration methods (RK4
                            recommended for accuracy)
                        </li>
                        <li>
                            Speed up or slow down time to observe long-term
                            orbital evolution
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Parameter Info Modal -->
        <div id="param-info-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="param-modal-title">Parameter Information</h2>
                    <button class="close-modal" data-modal="param-info-modal">
                        <i data-lucide="x" style="width: 24px; height: 24px"></i>
                    </button>
                </div>
                <div id="param-modal-content"></div>
            </div>
        </div>

        <script type="module" src="/src/main.ts"></script>
        <script>
            // Initialize Lucide icons
            lucide.createIcons();

            // Modal functionality
            document.querySelectorAll(".close-modal").forEach((btn) => {
                btn.addEventListener("click", function () {
                    const modalId = this.getAttribute("data-modal");
                    document.getElementById(modalId).style.display = "none";
                });
            });

            // Close modal when clicking outside
            window.addEventListener("click", function (event) {
                if (event.target.classList.contains("modal")) {
                    event.target.style.display = "none";
                }
            });

            // Main info button
            document
                .getElementById("main-info-btn")
                .addEventListener("click", function () {
                    document.getElementById("main-info-modal").style.display =
                        "block";
                    lucide.createIcons();
                });
        </script>
    </body>
</html>
